"use strict";const L=require("electron"),U=require("path"),ae=require("os"),Me=require("child_process"),H=require("fs"),Pr=require("constants"),je=require("assert"),Ir=require("events");require("util");const Rr=require("fs/promises");async function Tr(s){let d=new L.BrowserWindow({frame:!1,fullscreen:!s,width:0,height:0,x:0,y:0,transparent:!0,resizable:!1,movable:!1,autoHideMenuBar:!0,enableLargerThanScreen:!0,skipTaskbar:!0,alwaysOnTop:!0,hasShadow:!1,webPreferences:{webSecurity:!1,nodeIntegration:!1,contextIsolation:!0,preload:U.join(__dirname,"preload.js")}});return d.setOpacity(0),d.setIgnoreMouseEvents(!0),d.setAlwaysOnTop(!0,"screen-saver",999),d.setVisibleOnAllWorkspaces(!0,{visibleOnFullScreen:!0}),d.on("closed",()=>{d.destroy()}),await d.loadFile(U.join(__dirname,"../electron/captureWindow/capture.html")),d}function Mr(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ne={exports:{}},ye,Ue;function Ce(){if(Ue)return ye;Ue=1;const s=H;function d(S){return new Promise((A,D)=>{s.unlink(S,function(R){return R?D(R):A()})})}function b(S){return new Promise((A,D)=>{s.readFile(S,function(R,_){if(R)return D(R);A(_)})})}function I(S){return new Promise((A,D)=>{b(S).then(R=>{d(S).then(()=>A(R)).catch(D)}).catch(D)})}function E(S){return new Promise((A,D)=>{S.listDisplays().then(R=>{const _=R.map(({id:k})=>S({screen:k}));Promise.all(_).then(A).catch(D)}).catch(D)})}return ye={unlinkP:d,readFileP:b,readAndUnlinkP:I,defaultAll:E},ye}var ge,Ye;function jr(){if(Ye)return ge;Ye=1;const s=Me.exec,d=U,b=Ce().defaultAll,I=`Screen 0: minimum 320 x 200, current 5760 x 1080, maximum 8192 x 8192
eDP-1 connected (normal left inverted right x axis y axis)
  2560x1440     60.00 +
  1920x1440     60.00
  1856x1392     60.01
  1792x1344     60.01
  1920x1200     59.95
  1920x1080     59.93
  1600x1200     60.00
  1680x1050     59.95    59.88
  1600x1024     60.17
  1400x1050     59.98
  1280x1024     60.02
  1440x900      59.89
  1280x960      60.00
  1360x768      59.80    59.96
  1152x864      60.00
  1024x768      60.04    60.00
  960x720       60.00
  928x696       60.05
  896x672       60.01
  960x600       60.00
  960x540       59.99
  800x600       60.00    60.32    56.25
  840x525       60.01    59.88
  800x512       60.17
  700x525       59.98
  640x512       60.02
  720x450       59.89
  640x480       60.00    59.94
  680x384       59.80    59.96
  576x432       60.06
  512x384       60.00
  400x300       60.32    56.34
  320x240       60.05
DP-1 disconnected (normal left inverted right x axis y axis)
HDMI-1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 476mm x 268mm
  1920x1080     60.00*+  50.00    50.00    59.94
  1680x1050     59.88
  1600x900      60.00
  1280x1024     60.02
  1440x900      59.90
  1280x800      59.91
  1280x720      60.00    50.00    59.94
  1024x768      60.00
  800x600       60.32
  720x576       50.00
  720x480       60.00    59.94
  640x480       60.00    59.94
  720x400       70.08
DP-2 disconnected (normal left inverted right x axis y axis)
HDMI-2 disconnected (normal left inverted right x axis y axis)
DP-2-1 connected 1920x1080+3840+0 (normal left inverted right x axis y axis) 476mm x 268mm
  1920x1080     60.00*+  50.00    50.00    59.94
  1680x1050     59.88
  1600x900      60.00
  1280x1024     60.02
  1440x900      59.90
  1280x800      59.91
  1280x720      60.00    50.00    59.94
  1024x768      60.00
  800x600       60.32
  720x576       50.00
  720x480       60.00    59.94
  640x480       60.00    59.94
  720x400       70.08
DP-2-2 connected 1920x1080+1920+0 (normal left inverted right x axis y axis) 476mm x 268mm
  1920x1080     60.00*+  50.00    50.00    59.94
  1680x1050     59.88
  1600x900      60.00
  1280x1024     60.02
  1440x900      59.90
  1280x800      59.91
  1280x720      60.00    50.00    59.94
  1024x768      60.00
  800x600       60.32
  720x576       50.00
  720x480       60.00    59.94
  640x480       60.00    59.94
  720x400       70.08
DP-2-3 disconnected (normal left inverted right x axis y axis)`;function E(_){return _.split(`
`).filter(k=>k.indexOf(" connected ")>0).filter(k=>k.search(/\dx\d/)>0).map((k,x)=>{const o=k.split(" "),p=o[0],g=o[2]==="primary",i=g?o[3]:o[2],u=i.split(/[x+]/),r=+u[0],t=+u[1],c=+u[2],e=+u[3];return{width:r,height:t,name:p,id:p,offsetX:c,offsetY:e,primary:g,crop:i}})}function S(){return new Promise((_,k)=>{s("xrandr",(x,o)=>x?k(x):_(E(o)))})}function A(_){let k=0;return _.forEach(x=>{k+=x.height*x.width}),k}function D(_){switch(d.extname(_)){case".jpg":case".jpeg":return"jpeg";case".png":return"png"}return"jpeg"}function R(_={}){return new Promise((k,x)=>{S().then(o=>{const p=o.find(_.screen?t=>t.id===_.screen:t=>t.primary||t.id==="default")||o[0],g=_.filename?_.filename.replace(/"/g,'\\"'):"-",i=_.filename?{}:{encoding:"buffer",maxBuffer:A(o)},u=_.format||D(g);let r="";switch(_.linuxLibrary){case"scrot":r=`scrot "${g}" -e -z "echo \\"${g}\\""`;break;case"imagemagick":default:r=`import -silent -window root -crop ${p.crop} -screen ${u}:"${g}" `;break}s(r,i,(t,c)=>t?x(t):k(_.filename?d.resolve(_.filename):c))})})}return R.listDisplays=S,R.parseDisplaysOutput=E,R.EXAMPLE_DISPLAYS_OUTPUT=I,R.all=()=>b(R),ge=R,ge}var se={exports:{}},oe={},ze;function Cr(){if(ze)return oe;ze=1;var s=U,d=process.platform==="win32",b=H,I=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function E(){var R;if(I){var _=new Error;R=k}else R=x;return R;function k(o){o&&(_.message=o.message,o=_,x(o))}function x(o){if(o){if(process.throwDeprecation)throw o;if(!process.noDeprecation){var p="fs: missing callback "+(o.stack||o.message);process.traceDeprecation?console.trace(p):console.error(p)}}}}function S(R){return typeof R=="function"?R:E()}if(s.normalize,d)var A=/(.*?)(?:[\/\\]+|$)/g;else var A=/(.*?)(?:[\/]+|$)/g;if(d)var D=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else var D=/^[\/]*/;return oe.realpathSync=function(_,k){if(_=s.resolve(_),k&&Object.prototype.hasOwnProperty.call(k,_))return k[_];var x=_,o={},p={},g,i,u,r;t();function t(){var l=D.exec(_);g=l[0].length,i=l[0],u=l[0],r="",d&&!p[u]&&(b.lstatSync(u),p[u]=!0)}for(;g<_.length;){A.lastIndex=g;var c=A.exec(_);if(r=i,i+=c[0],u=r+c[1],g=A.lastIndex,!(p[u]||k&&k[u]===u)){var e;if(k&&Object.prototype.hasOwnProperty.call(k,u))e=k[u];else{var a=b.lstatSync(u);if(!a.isSymbolicLink()){p[u]=!0,k&&(k[u]=u);continue}var f=null;if(!d){var v=a.dev.toString(32)+":"+a.ino.toString(32);o.hasOwnProperty(v)&&(f=o[v])}f===null&&(b.statSync(u),f=b.readlinkSync(u)),e=s.resolve(r,f),k&&(k[u]=e),d||(o[v]=f)}_=s.resolve(e,_.slice(g)),t()}}return k&&(k[x]=_),_},oe.realpath=function(_,k,x){if(typeof x!="function"&&(x=S(k),k=null),_=s.resolve(_),k&&Object.prototype.hasOwnProperty.call(k,_))return process.nextTick(x.bind(null,null,k[_]));var o=_,p={},g={},i,u,r,t;c();function c(){var l=D.exec(_);i=l[0].length,u=l[0],r=l[0],t="",d&&!g[r]?b.lstat(r,function(n){if(n)return x(n);g[r]=!0,e()}):process.nextTick(e)}function e(){if(i>=_.length)return k&&(k[o]=_),x(null,_);A.lastIndex=i;var l=A.exec(_);return t=u,u+=l[0],r=t+l[1],i=A.lastIndex,g[r]||k&&k[r]===r?process.nextTick(e):k&&Object.prototype.hasOwnProperty.call(k,r)?v(k[r]):b.lstat(r,a)}function a(l,n){if(l)return x(l);if(!n.isSymbolicLink())return g[r]=!0,k&&(k[r]=r),process.nextTick(e);if(!d){var h=n.dev.toString(32)+":"+n.ino.toString(32);if(p.hasOwnProperty(h))return f(null,p[h],r)}b.stat(r,function(y){if(y)return x(y);b.readlink(r,function(m,O){d||(p[h]=O),f(m,O)})})}function f(l,n,h){if(l)return x(l);var y=s.resolve(t,n);k&&(k[h]=y),v(y)}function v(l){_=s.resolve(l,_.slice(i)),c()}},oe}var we,Xe;function dr(){if(Xe)return we;Xe=1,we=D,D.realpath=D,D.sync=R,D.realpathSync=R,D.monkeypatch=_,D.unmonkeypatch=k;var s=H,d=s.realpath,b=s.realpathSync,I=process.version,E=/^v[0-5]\./.test(I),S=Cr();function A(x){return x&&x.syscall==="realpath"&&(x.code==="ELOOP"||x.code==="ENOMEM"||x.code==="ENAMETOOLONG")}function D(x,o,p){if(E)return d(x,o,p);typeof o=="function"&&(p=o,o=null),d(x,o,function(g,i){A(g)?S.realpath(x,o,p):p(g,i)})}function R(x,o){if(E)return b(x,o);try{return b(x,o)}catch(p){if(A(p))return S.realpathSync(x,o);throw p}}function _(){s.realpath=D,s.realpathSync=R}function k(){s.realpath=d,s.realpathSync=b}return we}var Ee,He;function Nr(){if(He)return Ee;He=1,Ee=function(d,b){for(var I=[],E=0;E<d.length;E++){var S=b(d[E],E);s(S)?I.push.apply(I,S):I.push(S)}return I};var s=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"};return Ee}var Se,Qe;function qr(){if(Qe)return Se;Qe=1,Se=s;function s(I,E,S){I instanceof RegExp&&(I=d(I,S)),E instanceof RegExp&&(E=d(E,S));var A=b(I,E,S);return A&&{start:A[0],end:A[1],pre:S.slice(0,A[0]),body:S.slice(A[0]+I.length,A[1]),post:S.slice(A[1]+E.length)}}function d(I,E){var S=E.match(I);return S?S[0]:null}s.range=b;function b(I,E,S){var A,D,R,_,k,x=S.indexOf(I),o=S.indexOf(E,x+1),p=x;if(x>=0&&o>0){if(I===E)return[x,o];for(A=[],R=S.length;p>=0&&!k;)p==x?(A.push(p),x=S.indexOf(I,p+1)):A.length==1?k=[A.pop(),o]:(D=A.pop(),D<R&&(R=D,_=o),o=S.indexOf(E,p+1)),p=x<o&&x>=0?x:o;A.length&&(k=[R,_])}return k}return Se}var be,Ve;function Lr(){if(Ve)return be;Ve=1;var s=Nr(),d=qr();be=x;var b="\0SLASH"+Math.random()+"\0",I="\0OPEN"+Math.random()+"\0",E="\0CLOSE"+Math.random()+"\0",S="\0COMMA"+Math.random()+"\0",A="\0PERIOD"+Math.random()+"\0";function D(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function R(r){return r.split("\\\\").join(b).split("\\{").join(I).split("\\}").join(E).split("\\,").join(S).split("\\.").join(A)}function _(r){return r.split(b).join("\\").split(I).join("{").split(E).join("}").split(S).join(",").split(A).join(".")}function k(r){if(!r)return[""];var t=[],c=d("{","}",r);if(!c)return r.split(",");var e=c.pre,a=c.body,f=c.post,v=e.split(",");v[v.length-1]+="{"+a+"}";var l=k(f);return f.length&&(v[v.length-1]+=l.shift(),v.push.apply(v,l)),t.push.apply(t,v),t}function x(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),u(R(r),!0).map(_)):[]}function o(r){return"{"+r+"}"}function p(r){return/^-?0\d/.test(r)}function g(r,t){return r<=t}function i(r,t){return r>=t}function u(r,t){var c=[],e=d("{","}",r);if(!e||/\$$/.test(e.pre))return[r];var a=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(e.body),f=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(e.body),v=a||f,l=e.body.indexOf(",")>=0;if(!v&&!l)return e.post.match(/,.*\}/)?(r=e.pre+"{"+e.body+E+e.post,u(r)):[r];var n;if(v)n=e.body.split(/\.\./);else if(n=k(e.body),n.length===1&&(n=u(n[0],!1).map(o),n.length===1)){var y=e.post.length?u(e.post,!1):[""];return y.map(function(Q){return e.pre+n[0]+Q})}var h=e.pre,y=e.post.length?u(e.post,!1):[""],m;if(v){var O=D(n[0]),T=D(n[1]),j=Math.max(n[0].length,n[1].length),B=n.length==3?Math.abs(D(n[2])):1,w=g,P=T<O;P&&(B*=-1,w=i);var M=n.some(p);m=[];for(var C=O;w(C,T);C+=B){var N;if(f)N=String.fromCharCode(C),N==="\\"&&(N="");else if(N=String(C),M){var q=j-N.length;if(q>0){var G=new Array(q+1).join("0");C<0?N="-"+G+N.slice(1):N=G+N}}m.push(N)}}else m=s(n,function(W){return u(W,!1)});for(var $=0;$<m.length;$++)for(var K=0;K<y.length;K++){var F=h+m[$]+y[K];(!t||v||F)&&c.push(F)}return c}return be}var xe,Ze;function Ne(){if(Ze)return xe;Ze=1,xe=p,p.Minimatch=g;var s=function(){try{return require("path")}catch{}}()||{sep:"/"};p.sep=s.sep;var d=p.GLOBSTAR=g.GLOBSTAR={},b=Lr(),I={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},E="[^/]",S=E+"*?",A="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",D="(?:(?!(?:\\/|^)\\.).)*?",R=_("().*{}+?[]^$\\!");function _(n){return n.split("").reduce(function(h,y){return h[y]=!0,h},{})}var k=/\/+/;p.filter=x;function x(n,h){return h=h||{},function(y,m,O){return p(y,n,h)}}function o(n,h){h=h||{};var y={};return Object.keys(n).forEach(function(m){y[m]=n[m]}),Object.keys(h).forEach(function(m){y[m]=h[m]}),y}p.defaults=function(n){if(!n||typeof n!="object"||!Object.keys(n).length)return p;var h=p,y=function(O,T,j){return h(O,T,o(n,j))};return y.Minimatch=function(O,T){return new h.Minimatch(O,o(n,T))},y.Minimatch.defaults=function(O){return h.defaults(o(n,O)).Minimatch},y.filter=function(O,T){return h.filter(O,o(n,T))},y.defaults=function(O){return h.defaults(o(n,O))},y.makeRe=function(O,T){return h.makeRe(O,o(n,T))},y.braceExpand=function(O,T){return h.braceExpand(O,o(n,T))},y.match=function(m,O,T){return h.match(m,O,o(n,T))},y},g.defaults=function(n){return p.defaults(n).Minimatch};function p(n,h,y){return c(h),y||(y={}),!y.nocomment&&h.charAt(0)==="#"?!1:new g(h,y).match(n)}function g(n,h){if(!(this instanceof g))return new g(n,h);c(n),h||(h={}),n=n.trim(),!h.allowWindowsEscape&&s.sep!=="/"&&(n=n.split(s.sep).join("/")),this.options=h,this.set=[],this.pattern=n,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!h.partial,this.make()}g.prototype.debug=function(){},g.prototype.make=i;function i(){var n=this.pattern,h=this.options;if(!h.nocomment&&n.charAt(0)==="#"){this.comment=!0;return}if(!n){this.empty=!0;return}this.parseNegate();var y=this.globSet=this.braceExpand();h.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,y),y=this.globParts=y.map(function(m){return m.split(k)}),this.debug(this.pattern,y),y=y.map(function(m,O,T){return m.map(this.parse,this)},this),this.debug(this.pattern,y),y=y.filter(function(m){return m.indexOf(!1)===-1}),this.debug(this.pattern,y),this.set=y}g.prototype.parseNegate=u;function u(){var n=this.pattern,h=!1,y=this.options,m=0;if(!y.nonegate){for(var O=0,T=n.length;O<T&&n.charAt(O)==="!";O++)h=!h,m++;m&&(this.pattern=n.substr(m)),this.negate=h}}p.braceExpand=function(n,h){return r(n,h)},g.prototype.braceExpand=r;function r(n,h){return h||(this instanceof g?h=this.options:h={}),n=typeof n>"u"?this.pattern:n,c(n),h.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:b(n)}var t=1024*64,c=function(n){if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>t)throw new TypeError("pattern is too long")};g.prototype.parse=a;var e={};function a(n,h){c(n);var y=this.options;if(n==="**")if(y.noglobstar)n="*";else return d;if(n==="")return"";var m="",O=!!y.nocase,T=!1,j=[],B=[],w,P=!1,M=-1,C=-1,N=n.charAt(0)==="."?"":y.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",q=this;function G(){if(w){switch(w){case"*":m+=S,O=!0;break;case"?":m+=E,O=!0;break;default:m+="\\"+w;break}q.debug("clearStateChar %j %j",w,m),w=!1}}for(var $=0,K=n.length,F;$<K&&(F=n.charAt($));$++){if(this.debug("%s	%s %s %j",n,$,m,F),T&&R[F]){m+="\\"+F,T=!1;continue}switch(F){case"/":return!1;case"\\":G(),T=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",n,$,m,F),P){this.debug("  in class"),F==="!"&&$===C+1&&(F="^"),m+=F;continue}q.debug("call clearStateChar %j",w),G(),w=F,y.noext&&G();continue;case"(":if(P){m+="(";continue}if(!w){m+="\\(";continue}j.push({type:w,start:$-1,reStart:m.length,open:I[w].open,close:I[w].close}),m+=w==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",w,m),w=!1;continue;case")":if(P||!j.length){m+="\\)";continue}G(),O=!0;var W=j.pop();m+=W.close,W.type==="!"&&B.push(W),W.reEnd=m.length;continue;case"|":if(P||!j.length||T){m+="\\|",T=!1;continue}G(),m+="|";continue;case"[":if(G(),P){m+="\\"+F;continue}P=!0,C=$,M=m.length,m+=F;continue;case"]":if($===C+1||!P){m+="\\"+F,T=!1;continue}var Q=n.substring(C+1,$);try{RegExp("["+Q+"]")}catch{var J=this.parse(Q,e);m=m.substr(0,M)+"\\["+J[0]+"\\]",O=O||J[1],P=!1;continue}O=!0,P=!1,m+=F;continue;default:G(),T?T=!1:R[F]&&!(F==="^"&&P)&&(m+="\\"),m+=F}}for(P&&(Q=n.substr(C+1),J=this.parse(Q,e),m=m.substr(0,M)+"\\["+J[0],O=O||J[1]),W=j.pop();W;W=j.pop()){var ee=m.slice(W.reStart+W.open.length);this.debug("setting tail",m,W),ee=ee.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Fe,We,me){return me||(me="\\"),We+We+me+"|"}),this.debug(`tail=%j
   %s`,ee,ee,W,m);var _r=W.type==="*"?S:W.type==="?"?E:"\\"+W.type;O=!0,m=m.slice(0,W.reStart)+_r+"\\("+ee}G(),T&&(m+="\\\\");var Le=!1;switch(m.charAt(0)){case"[":case".":case"(":Le=!0}for(var de=B.length-1;de>-1;de--){var V=B[de],Be=m.slice(0,V.reStart),Or=m.slice(V.reStart,V.reEnd-8),$e=m.slice(V.reEnd-8,V.reEnd),re=m.slice(V.reEnd);$e+=re;var kr=Be.split("(").length-1,ve=re;for($=0;$<kr;$++)ve=ve.replace(/\)[+*?]?/,"");re=ve;var Ge="";re===""&&h!==e&&(Ge="$");var Ar=Be+Or+re+Ge+$e;m=Ar}if(m!==""&&O&&(m="(?=.)"+m),Le&&(m=N+m),h===e)return[m,O];if(!O)return v(n);var Dr=y.nocase?"i":"";try{var pe=new RegExp("^"+m+"$",Dr)}catch{return new RegExp("$.")}return pe._glob=n,pe._src=m,pe}p.makeRe=function(n,h){return new g(n,h||{}).makeRe()},g.prototype.makeRe=f;function f(){if(this.regexp||this.regexp===!1)return this.regexp;var n=this.set;if(!n.length)return this.regexp=!1,this.regexp;var h=this.options,y=h.noglobstar?S:h.dot?A:D,m=h.nocase?"i":"",O=n.map(function(T){return T.map(function(j){return j===d?y:typeof j=="string"?l(j):j._src}).join("\\/")}).join("|");O="^(?:"+O+")$",this.negate&&(O="^(?!"+O+").*$");try{this.regexp=new RegExp(O,m)}catch{this.regexp=!1}return this.regexp}p.match=function(n,h,y){y=y||{};var m=new g(h,y);return n=n.filter(function(O){return m.match(O)}),m.options.nonull&&!n.length&&n.push(h),n},g.prototype.match=function(h,y){if(typeof y>"u"&&(y=this.partial),this.debug("match",h,this.pattern),this.comment)return!1;if(this.empty)return h==="";if(h==="/"&&y)return!0;var m=this.options;s.sep!=="/"&&(h=h.split(s.sep).join("/")),h=h.split(k),this.debug(this.pattern,"split",h);var O=this.set;this.debug(this.pattern,"set",O);var T,j;for(j=h.length-1;j>=0&&(T=h[j],!T);j--);for(j=0;j<O.length;j++){var B=O[j],w=h;m.matchBase&&B.length===1&&(w=[T]);var P=this.matchOne(w,B,y);if(P)return m.flipNegate?!0:!this.negate}return m.flipNegate?!1:this.negate},g.prototype.matchOne=function(n,h,y){var m=this.options;this.debug("matchOne",{this:this,file:n,pattern:h}),this.debug("matchOne",n.length,h.length);for(var O=0,T=0,j=n.length,B=h.length;O<j&&T<B;O++,T++){this.debug("matchOne loop");var w=h[T],P=n[O];if(this.debug(h,w,P),w===!1)return!1;if(w===d){this.debug("GLOBSTAR",[h,w,P]);var M=O,C=T+1;if(C===B){for(this.debug("** at the end");O<j;O++)if(n[O]==="."||n[O]===".."||!m.dot&&n[O].charAt(0)===".")return!1;return!0}for(;M<j;){var N=n[M];if(this.debug(`
globstar while`,n,M,h,C,N),this.matchOne(n.slice(M),h.slice(C),y))return this.debug("globstar found match!",M,j,N),!0;if(N==="."||N===".."||!m.dot&&N.charAt(0)==="."){this.debug("dot detected!",n,M,h,C);break}this.debug("globstar swallow a segment, and continue"),M++}return!!(y&&(this.debug(`
>>> no match, partial?`,n,M,h,C),M===j))}var q;if(typeof w=="string"?(q=P===w,this.debug("string match",w,P,q)):(q=P.match(w),this.debug("pattern match",w,P,q)),!q)return!1}if(O===j&&T===B)return!0;if(O===j)return y;if(T===B)return O===j-1&&n[O]==="";throw new Error("wtf?")};function v(n){return n.replace(/\\(.)/g,"$1")}function l(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}return xe}var ce={exports:{}},ue={exports:{}},Ke;function Br(){return Ke||(Ke=1,typeof Object.create=="function"?ue.exports=function(d,b){b&&(d.super_=b,d.prototype=Object.create(b.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}))}:ue.exports=function(d,b){if(b){d.super_=b;var I=function(){};I.prototype=b.prototype,d.prototype=new I,d.prototype.constructor=d}}),ue.exports}var Je;function $r(){if(Je)return ce.exports;Je=1;try{var s=require("util");if(typeof s.inherits!="function")throw"";ce.exports=s.inherits}catch{ce.exports=Br()}return ce.exports}var te={exports:{}},er;function qe(){if(er)return te.exports;er=1;function s(b){return b.charAt(0)==="/"}function d(b){var I=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,E=I.exec(b),S=E[1]||"",A=!!(S&&S.charAt(1)!==":");return!!(E[2]||A)}return te.exports=process.platform==="win32"?d:s,te.exports.posix=s,te.exports.win32=d,te.exports}var X={},rr;function vr(){if(rr)return X;rr=1,X.setopts=_,X.ownProp=s,X.makeAbs=o,X.finish=k,X.mark=x,X.isIgnored=p,X.childrenIgnored=g;function s(i,u){return Object.prototype.hasOwnProperty.call(i,u)}var d=H,b=U,I=Ne(),E=qe(),S=I.Minimatch;function A(i,u){return i.localeCompare(u,"en")}function D(i,u){i.ignore=u.ignore||[],Array.isArray(i.ignore)||(i.ignore=[i.ignore]),i.ignore.length&&(i.ignore=i.ignore.map(R))}function R(i){var u=null;if(i.slice(-3)==="/**"){var r=i.replace(/(\/\*\*)+$/,"");u=new S(r,{dot:!0})}return{matcher:new S(i,{dot:!0}),gmatcher:u}}function _(i,u,r){if(r||(r={}),r.matchBase&&u.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");u="**/"+u}i.silent=!!r.silent,i.pattern=u,i.strict=r.strict!==!1,i.realpath=!!r.realpath,i.realpathCache=r.realpathCache||Object.create(null),i.follow=!!r.follow,i.dot=!!r.dot,i.mark=!!r.mark,i.nodir=!!r.nodir,i.nodir&&(i.mark=!0),i.sync=!!r.sync,i.nounique=!!r.nounique,i.nonull=!!r.nonull,i.nosort=!!r.nosort,i.nocase=!!r.nocase,i.stat=!!r.stat,i.noprocess=!!r.noprocess,i.absolute=!!r.absolute,i.fs=r.fs||d,i.maxLength=r.maxLength||1/0,i.cache=r.cache||Object.create(null),i.statCache=r.statCache||Object.create(null),i.symlinks=r.symlinks||Object.create(null),D(i,r),i.changedCwd=!1;var t=process.cwd();s(r,"cwd")?(i.cwd=b.resolve(r.cwd),i.changedCwd=i.cwd!==t):i.cwd=t,i.root=r.root||b.resolve(i.cwd,"/"),i.root=b.resolve(i.root),process.platform==="win32"&&(i.root=i.root.replace(/\\/g,"/")),i.cwdAbs=E(i.cwd)?i.cwd:o(i,i.cwd),process.platform==="win32"&&(i.cwdAbs=i.cwdAbs.replace(/\\/g,"/")),i.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!1,i.minimatch=new S(u,r),i.options=i.minimatch.options}function k(i){for(var u=i.nounique,r=u?[]:Object.create(null),t=0,c=i.matches.length;t<c;t++){var e=i.matches[t];if(!e||Object.keys(e).length===0){if(i.nonull){var a=i.minimatch.globSet[t];u?r.push(a):r[a]=!0}}else{var f=Object.keys(e);u?r.push.apply(r,f):f.forEach(function(v){r[v]=!0})}}if(u||(r=Object.keys(r)),i.nosort||(r=r.sort(A)),i.mark){for(var t=0;t<r.length;t++)r[t]=i._mark(r[t]);i.nodir&&(r=r.filter(function(v){var l=!/\/$/.test(v),n=i.cache[v]||i.cache[o(i,v)];return l&&n&&(l=n!=="DIR"&&!Array.isArray(n)),l}))}i.ignore.length&&(r=r.filter(function(v){return!p(i,v)})),i.found=r}function x(i,u){var r=o(i,u),t=i.cache[r],c=u;if(t){var e=t==="DIR"||Array.isArray(t),a=u.slice(-1)==="/";if(e&&!a?c+="/":!e&&a&&(c=c.slice(0,-1)),c!==u){var f=o(i,c);i.statCache[f]=i.statCache[r],i.cache[f]=i.cache[r]}}return c}function o(i,u){var r=u;return u.charAt(0)==="/"?r=b.join(i.root,u):E(u)||u===""?r=u:i.changedCwd?r=b.resolve(i.cwd,u):r=b.resolve(u),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function p(i,u){return i.ignore.length?i.ignore.some(function(r){return r.matcher.match(u)||!!(r.gmatcher&&r.gmatcher.match(u))}):!1}function g(i,u){return i.ignore.length?i.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(u))}):!1}return X}var _e,tr;function Gr(){if(tr)return _e;tr=1,_e=k,k.GlobSync=x;var s=dr(),d=Ne();d.Minimatch,yr().Glob;var b=U,I=je,E=qe(),S=vr(),A=S.setopts,D=S.ownProp,R=S.childrenIgnored,_=S.isIgnored;function k(o,p){if(typeof p=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new x(o,p).found}function x(o,p){if(!o)throw new Error("must provide pattern");if(typeof p=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof x))return new x(o,p);if(A(this,o,p),this.noprocess)return this;var g=this.minimatch.set.length;this.matches=new Array(g);for(var i=0;i<g;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}return x.prototype._finish=function(){if(I.ok(this instanceof x),this.realpath){var o=this;this.matches.forEach(function(p,g){var i=o.matches[g]=Object.create(null);for(var u in p)try{u=o._makeAbs(u);var r=s.realpathSync(u,o.realpathCache);i[r]=!0}catch(t){if(t.syscall==="stat")i[o._makeAbs(u)]=!0;else throw t}})}S.finish(this)},x.prototype._process=function(o,p,g){I.ok(this instanceof x);for(var i=0;typeof o[i]=="string";)i++;var u;switch(i){case o.length:this._processSimple(o.join("/"),p);return;case 0:u=null;break;default:u=o.slice(0,i).join("/");break}var r=o.slice(i),t;u===null?t=".":((E(u)||E(o.map(function(a){return typeof a=="string"?a:"[*]"}).join("/")))&&(!u||!E(u))&&(u="/"+u),t=u);var c=this._makeAbs(t);if(!R(this,t)){var e=r[0]===d.GLOBSTAR;e?this._processGlobStar(u,t,c,r,p,g):this._processReaddir(u,t,c,r,p,g)}},x.prototype._processReaddir=function(o,p,g,i,u,r){var t=this._readdir(g,r);if(t){for(var c=i[0],e=!!this.minimatch.negate,a=c._glob,f=this.dot||a.charAt(0)===".",v=[],l=0;l<t.length;l++){var n=t[l];if(n.charAt(0)!=="."||f){var h;e&&!o?h=!n.match(c):h=n.match(c),h&&v.push(n)}}var y=v.length;if(y!==0){if(i.length===1&&!this.mark&&!this.stat){this.matches[u]||(this.matches[u]=Object.create(null));for(var l=0;l<y;l++){var n=v[l];o&&(o.slice(-1)!=="/"?n=o+"/"+n:n=o+n),n.charAt(0)==="/"&&!this.nomount&&(n=b.join(this.root,n)),this._emitMatch(u,n)}return}i.shift();for(var l=0;l<y;l++){var n=v[l],m;o?m=[o,n]:m=[n],this._process(m.concat(i),u,r)}}}},x.prototype._emitMatch=function(o,p){if(!_(this,p)){var g=this._makeAbs(p);if(this.mark&&(p=this._mark(p)),this.absolute&&(p=g),!this.matches[o][p]){if(this.nodir){var i=this.cache[g];if(i==="DIR"||Array.isArray(i))return}this.matches[o][p]=!0,this.stat&&this._stat(p)}}},x.prototype._readdirInGlobStar=function(o){if(this.follow)return this._readdir(o,!1);var p,g;try{g=this.fs.lstatSync(o)}catch(u){if(u.code==="ENOENT")return null}var i=g&&g.isSymbolicLink();return this.symlinks[o]=i,!i&&g&&!g.isDirectory()?this.cache[o]="FILE":p=this._readdir(o,!1),p},x.prototype._readdir=function(o,p){if(p&&!D(this.symlinks,o))return this._readdirInGlobStar(o);if(D(this.cache,o)){var g=this.cache[o];if(!g||g==="FILE")return null;if(Array.isArray(g))return g}try{return this._readdirEntries(o,this.fs.readdirSync(o))}catch(i){return this._readdirError(o,i),null}},x.prototype._readdirEntries=function(o,p){if(!this.mark&&!this.stat)for(var g=0;g<p.length;g++){var i=p[g];o==="/"?i=o+i:i=o+"/"+i,this.cache[i]=!0}return this.cache[o]=p,p},x.prototype._readdirError=function(o,p){switch(p.code){case"ENOTSUP":case"ENOTDIR":var g=this._makeAbs(o);if(this.cache[g]="FILE",g===this.cwdAbs){var i=new Error(p.code+" invalid cwd "+this.cwd);throw i.path=this.cwd,i.code=p.code,i}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(o)]=!1;break;default:if(this.cache[this._makeAbs(o)]=!1,this.strict)throw p;this.silent||console.error("glob error",p);break}},x.prototype._processGlobStar=function(o,p,g,i,u,r){var t=this._readdir(g,r);if(t){var c=i.slice(1),e=o?[o]:[],a=e.concat(c);this._process(a,u,!1);var f=t.length,v=this.symlinks[g];if(!(v&&r))for(var l=0;l<f;l++){var n=t[l];if(!(n.charAt(0)==="."&&!this.dot)){var h=e.concat(t[l],c);this._process(h,u,!0);var y=e.concat(t[l],i);this._process(y,u,!0)}}}},x.prototype._processSimple=function(o,p){var g=this._stat(o);if(this.matches[p]||(this.matches[p]=Object.create(null)),!!g){if(o&&E(o)&&!this.nomount){var i=/[\/\\]$/.test(o);o.charAt(0)==="/"?o=b.join(this.root,o):(o=b.resolve(this.root,o),i&&(o+="/"))}process.platform==="win32"&&(o=o.replace(/\\/g,"/")),this._emitMatch(p,o)}},x.prototype._stat=function(o){var p=this._makeAbs(o),g=o.slice(-1)==="/";if(o.length>this.maxLength)return!1;if(!this.stat&&D(this.cache,p)){var r=this.cache[p];if(Array.isArray(r)&&(r="DIR"),!g||r==="DIR")return r;if(g&&r==="FILE")return!1}var i=this.statCache[p];if(!i){var u;try{u=this.fs.lstatSync(p)}catch(t){if(t&&(t.code==="ENOENT"||t.code==="ENOTDIR"))return this.statCache[p]=!1,!1}if(u&&u.isSymbolicLink())try{i=this.fs.statSync(p)}catch{i=u}else i=u}this.statCache[p]=i;var r=!0;return i&&(r=i.isDirectory()?"DIR":"FILE"),this.cache[p]=this.cache[p]||r,g&&r==="FILE"?!1:r},x.prototype._mark=function(o){return S.mark(this,o)},x.prototype._makeAbs=function(o){return S.makeAbs(this,o)},_e}var Oe,nr;function pr(){if(nr)return Oe;nr=1,Oe=s;function s(d,b){if(d&&b)return s(d)(b);if(typeof d!="function")throw new TypeError("need wrapper function");return Object.keys(d).forEach(function(E){I[E]=d[E]}),I;function I(){for(var E=new Array(arguments.length),S=0;S<E.length;S++)E[S]=arguments[S];var A=d.apply(this,E),D=E[E.length-1];return typeof A=="function"&&A!==D&&Object.keys(D).forEach(function(R){A[R]=D[R]}),A}}return Oe}var le={exports:{}},ir;function mr(){if(ir)return le.exports;ir=1;var s=pr();le.exports=s(d),le.exports.strict=s(b),d.proto=d(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return d(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return b(this)},configurable:!0})});function d(I){var E=function(){return E.called?E.value:(E.called=!0,E.value=I.apply(this,arguments))};return E.called=!1,E}function b(I){var E=function(){if(E.called)throw new Error(E.onceError);return E.called=!0,E.value=I.apply(this,arguments)},S=I.name||"Function wrapped with `once`";return E.onceError=S+" shouldn't be called more than once",E.called=!1,E}return le.exports}var ke,ar;function Fr(){if(ar)return ke;ar=1;var s=pr(),d=Object.create(null),b=mr();ke=s(I);function I(A,D){return d[A]?(d[A].push(D),null):(d[A]=[D],E(A))}function E(A){return b(function D(){var R=d[A],_=R.length,k=S(arguments);try{for(var x=0;x<_;x++)R[x].apply(null,k)}finally{R.length>_?(R.splice(0,_),process.nextTick(function(){D.apply(null,k)})):delete d[A]}})}function S(A){for(var D=A.length,R=[],_=0;_<D;_++)R[_]=A[_];return R}return ke}var Ae,sr;function yr(){if(sr)return Ae;sr=1,Ae=i;var s=dr(),d=Ne();d.Minimatch;var b=$r(),I=Ir.EventEmitter,E=U,S=je,A=qe(),D=Gr(),R=vr(),_=R.setopts,k=R.ownProp,x=Fr(),o=R.childrenIgnored,p=R.isIgnored,g=mr();function i(e,a,f){if(typeof a=="function"&&(f=a,a={}),a||(a={}),a.sync){if(f)throw new TypeError("callback provided to sync glob");return D(e,a)}return new t(e,a,f)}i.sync=D;var u=i.GlobSync=D.GlobSync;i.glob=i;function r(e,a){if(a===null||typeof a!="object")return e;for(var f=Object.keys(a),v=f.length;v--;)e[f[v]]=a[f[v]];return e}i.hasMagic=function(e,a){var f=r({},a);f.noprocess=!0;var v=new t(e,f),l=v.minimatch.set;if(!e)return!1;if(l.length>1)return!0;for(var n=0;n<l[0].length;n++)if(typeof l[0][n]!="string")return!0;return!1},i.Glob=t,b(t,I);function t(e,a,f){if(typeof a=="function"&&(f=a,a=null),a&&a.sync){if(f)throw new TypeError("callback provided to sync glob");return new u(e,a)}if(!(this instanceof t))return new t(e,a,f);_(this,e,a),this._didRealPath=!1;var v=this.minimatch.set.length;this.matches=new Array(v),typeof f=="function"&&(f=g(f),this.on("error",f),this.on("end",function(m){f(null,m)}));var l=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(v===0)return y();for(var n=!0,h=0;h<v;h++)this._process(this.minimatch.set[h],h,!1,y);n=!1;function y(){--l._processing,l._processing<=0&&(n?process.nextTick(function(){l._finish()}):l._finish())}}t.prototype._finish=function(){if(S(this instanceof t),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();R.finish(this),this.emit("end",this.found)}},t.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var e=this.matches.length;if(e===0)return this._finish();for(var a=this,f=0;f<this.matches.length;f++)this._realpathSet(f,v);function v(){--e===0&&a._finish()}},t.prototype._realpathSet=function(e,a){var f=this.matches[e];if(!f)return a();var v=Object.keys(f),l=this,n=v.length;if(n===0)return a();var h=this.matches[e]=Object.create(null);v.forEach(function(y,m){y=l._makeAbs(y),s.realpath(y,l.realpathCache,function(O,T){O?O.syscall==="stat"?h[y]=!0:l.emit("error",O):h[T]=!0,--n===0&&(l.matches[e]=h,a())})})},t.prototype._mark=function(e){return R.mark(this,e)},t.prototype._makeAbs=function(e){return R.makeAbs(this,e)},t.prototype.abort=function(){this.aborted=!0,this.emit("abort")},t.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},t.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var a=0;a<e.length;a++){var f=e[a];this._emitMatch(f[0],f[1])}}if(this._processQueue.length){var v=this._processQueue.slice(0);this._processQueue.length=0;for(var a=0;a<v.length;a++){var l=v[a];this._processing--,this._process(l[0],l[1],l[2],l[3])}}}},t.prototype._process=function(e,a,f,v){if(S(this instanceof t),S(typeof v=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([e,a,f,v]);return}for(var l=0;typeof e[l]=="string";)l++;var n;switch(l){case e.length:this._processSimple(e.join("/"),a,v);return;case 0:n=null;break;default:n=e.slice(0,l).join("/");break}var h=e.slice(l),y;n===null?y=".":((A(n)||A(e.map(function(T){return typeof T=="string"?T:"[*]"}).join("/")))&&(!n||!A(n))&&(n="/"+n),y=n);var m=this._makeAbs(y);if(o(this,y))return v();var O=h[0]===d.GLOBSTAR;O?this._processGlobStar(n,y,m,h,a,f,v):this._processReaddir(n,y,m,h,a,f,v)}},t.prototype._processReaddir=function(e,a,f,v,l,n,h){var y=this;this._readdir(f,n,function(m,O){return y._processReaddir2(e,a,f,v,l,n,O,h)})},t.prototype._processReaddir2=function(e,a,f,v,l,n,h,y){if(!h)return y();for(var m=v[0],O=!!this.minimatch.negate,T=m._glob,j=this.dot||T.charAt(0)===".",B=[],w=0;w<h.length;w++){var P=h[w];if(P.charAt(0)!=="."||j){var M;O&&!e?M=!P.match(m):M=P.match(m),M&&B.push(P)}}var C=B.length;if(C===0)return y();if(v.length===1&&!this.mark&&!this.stat){this.matches[l]||(this.matches[l]=Object.create(null));for(var w=0;w<C;w++){var P=B[w];e&&(e!=="/"?P=e+"/"+P:P=e+P),P.charAt(0)==="/"&&!this.nomount&&(P=E.join(this.root,P)),this._emitMatch(l,P)}return y()}v.shift();for(var w=0;w<C;w++){var P=B[w];e&&(e!=="/"?P=e+"/"+P:P=e+P),this._process([P].concat(v),l,n,y)}y()},t.prototype._emitMatch=function(e,a){if(!this.aborted&&!p(this,a)){if(this.paused){this._emitQueue.push([e,a]);return}var f=A(a)?a:this._makeAbs(a);if(this.mark&&(a=this._mark(a)),this.absolute&&(a=f),!this.matches[e][a]){if(this.nodir){var v=this.cache[f];if(v==="DIR"||Array.isArray(v))return}this.matches[e][a]=!0;var l=this.statCache[f];l&&this.emit("stat",a,l),this.emit("match",a)}}},t.prototype._readdirInGlobStar=function(e,a){if(this.aborted)return;if(this.follow)return this._readdir(e,!1,a);var f="lstat\0"+e,v=this,l=x(f,n);l&&v.fs.lstat(e,l);function n(h,y){if(h&&h.code==="ENOENT")return a();var m=y&&y.isSymbolicLink();v.symlinks[e]=m,!m&&y&&!y.isDirectory()?(v.cache[e]="FILE",a()):v._readdir(e,!1,a)}},t.prototype._readdir=function(e,a,f){if(!this.aborted&&(f=x("readdir\0"+e+"\0"+a,f),!!f)){if(a&&!k(this.symlinks,e))return this._readdirInGlobStar(e,f);if(k(this.cache,e)){var v=this.cache[e];if(!v||v==="FILE")return f();if(Array.isArray(v))return f(null,v)}var l=this;l.fs.readdir(e,c(this,e,f))}};function c(e,a,f){return function(v,l){v?e._readdirError(a,v,f):e._readdirEntries(a,l,f)}}return t.prototype._readdirEntries=function(e,a,f){if(!this.aborted){if(!this.mark&&!this.stat)for(var v=0;v<a.length;v++){var l=a[v];e==="/"?l=e+l:l=e+"/"+l,this.cache[l]=!0}return this.cache[e]=a,f(null,a)}},t.prototype._readdirError=function(e,a,f){if(!this.aborted){switch(a.code){case"ENOTSUP":case"ENOTDIR":var v=this._makeAbs(e);if(this.cache[v]="FILE",v===this.cwdAbs){var l=new Error(a.code+" invalid cwd "+this.cwd);l.path=this.cwd,l.code=a.code,this.emit("error",l),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",a),this.abort()),this.silent||console.error("glob error",a);break}return f()}},t.prototype._processGlobStar=function(e,a,f,v,l,n,h){var y=this;this._readdir(f,n,function(m,O){y._processGlobStar2(e,a,f,v,l,n,O,h)})},t.prototype._processGlobStar2=function(e,a,f,v,l,n,h,y){if(!h)return y();var m=v.slice(1),O=e?[e]:[],T=O.concat(m);this._process(T,l,!1,y);var j=this.symlinks[f],B=h.length;if(j&&n)return y();for(var w=0;w<B;w++){var P=h[w];if(!(P.charAt(0)==="."&&!this.dot)){var M=O.concat(h[w],m);this._process(M,l,!0,y);var C=O.concat(h[w],v);this._process(C,l,!0,y)}}y()},t.prototype._processSimple=function(e,a,f){var v=this;this._stat(e,function(l,n){v._processSimple2(e,a,l,n,f)})},t.prototype._processSimple2=function(e,a,f,v,l){if(this.matches[a]||(this.matches[a]=Object.create(null)),!v)return l();if(e&&A(e)&&!this.nomount){var n=/[\/\\]$/.test(e);e.charAt(0)==="/"?e=E.join(this.root,e):(e=E.resolve(this.root,e),n&&(e+="/"))}process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this._emitMatch(a,e),l()},t.prototype._stat=function(e,a){var f=this._makeAbs(e),v=e.slice(-1)==="/";if(e.length>this.maxLength)return a();if(!this.stat&&k(this.cache,f)){var l=this.cache[f];if(Array.isArray(l)&&(l="DIR"),!v||l==="DIR")return a(null,l);if(v&&l==="FILE")return a()}var n=this.statCache[f];if(n!==void 0){if(n===!1)return a(null,n);var h=n.isDirectory()?"DIR":"FILE";return v&&h==="FILE"?a():a(null,h,n)}var y=this,m=x("stat\0"+f,O);m&&y.fs.lstat(f,m);function O(T,j){if(j&&j.isSymbolicLink())return y.fs.stat(f,function(B,w){B?y._stat2(e,f,null,j,a):y._stat2(e,f,B,w,a)});y._stat2(e,f,T,j,a)}},t.prototype._stat2=function(e,a,f,v,l){if(f&&(f.code==="ENOENT"||f.code==="ENOTDIR"))return this.statCache[a]=!1,l();var n=e.slice(-1)==="/";if(this.statCache[a]=v,a.slice(-1)==="/"&&v&&!v.isDirectory())return l(null,!1,v);var h=!0;return v&&(h=v.isDirectory()?"DIR":"FILE"),this.cache[a]=this.cache[a]||h,n&&h==="FILE"?l():l(null,h,v)},Ae}var De,or;function Wr(){if(or)return De;or=1,De=_,_.sync=i;var s=je,d=U,b=H,I=yr(),E=parseInt("666",8),S={nosort:!0,silent:!0},A=0,D=process.platform==="win32";function R(t){var c=["unlink","chmod","stat","lstat","rmdir","readdir"];c.forEach(function(e){t[e]=t[e]||b[e],e=e+"Sync",t[e]=t[e]||b[e]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob=t.disableGlob||!1,t.glob=t.glob||S}function _(t,c,e){typeof c=="function"&&(e=c,c={}),s(t,"rimraf: missing path"),s.equal(typeof t,"string","rimraf: path should be a string"),s.equal(typeof e,"function","rimraf: callback function required"),s(c,"rimraf: invalid options argument provided"),s.equal(typeof c,"object","rimraf: options should be object"),R(c);var a=0,f=null,v=0;if(c.disableGlob||!I.hasMagic(t))return n(null,[t]);c.lstat(t,function(h,y){if(!h)return n(null,[t]);I(t,c.glob,n)});function l(h){f=f||h,--v===0&&e(f)}function n(h,y){if(h)return e(h);if(v=y.length,v===0)return e();y.forEach(function(m){k(m,c,function O(T){if(T){if((T.code==="EBUSY"||T.code==="ENOTEMPTY"||T.code==="EPERM")&&a<c.maxBusyTries){a++;var j=a*100;return setTimeout(function(){k(m,c,O)},j)}if(T.code==="EMFILE"&&A<c.emfileWait)return setTimeout(function(){k(m,c,O)},A++);T.code==="ENOENT"&&(T=null)}A=0,l(T)})})}}function k(t,c,e){s(t),s(c),s(typeof e=="function"),c.lstat(t,function(a,f){if(a&&a.code==="ENOENT")return e(null);if(a&&a.code==="EPERM"&&D&&x(t,c,a,e),f&&f.isDirectory())return p(t,c,a,e);c.unlink(t,function(v){if(v){if(v.code==="ENOENT")return e(null);if(v.code==="EPERM")return D?x(t,c,v,e):p(t,c,v,e);if(v.code==="EISDIR")return p(t,c,v,e)}return e(v)})})}function x(t,c,e,a){s(t),s(c),s(typeof a=="function"),e&&s(e instanceof Error),c.chmod(t,E,function(f){f?a(f.code==="ENOENT"?null:e):c.stat(t,function(v,l){v?a(v.code==="ENOENT"?null:e):l.isDirectory()?p(t,c,e,a):c.unlink(t,a)})})}function o(t,c,e){s(t),s(c),e&&s(e instanceof Error);try{c.chmodSync(t,E)}catch(f){if(f.code==="ENOENT")return;throw e}try{var a=c.statSync(t)}catch(f){if(f.code==="ENOENT")return;throw e}a.isDirectory()?u(t,c,e):c.unlinkSync(t)}function p(t,c,e,a){s(t),s(c),e&&s(e instanceof Error),s(typeof a=="function"),c.rmdir(t,function(f){f&&(f.code==="ENOTEMPTY"||f.code==="EEXIST"||f.code==="EPERM")?g(t,c,a):f&&f.code==="ENOTDIR"?a(e):a(f)})}function g(t,c,e){s(t),s(c),s(typeof e=="function"),c.readdir(t,function(a,f){if(a)return e(a);var v=f.length;if(v===0)return c.rmdir(t,e);var l;f.forEach(function(n){_(d.join(t,n),c,function(h){if(!l){if(h)return e(l=h);--v===0&&c.rmdir(t,e)}})})})}function i(t,c){c=c||{},R(c),s(t,"rimraf: missing path"),s.equal(typeof t,"string","rimraf: path should be a string"),s(c,"rimraf: missing options"),s.equal(typeof c,"object","rimraf: options should be object");var e;if(c.disableGlob||!I.hasMagic(t))e=[t];else try{c.lstatSync(t),e=[t]}catch{e=I.sync(t,c.glob)}if(e.length)for(var a=0;a<e.length;a++){var t=e[a];try{var f=c.lstatSync(t)}catch(l){if(l.code==="ENOENT")return;l.code==="EPERM"&&D&&o(t,c,l)}try{f&&f.isDirectory()?u(t,c,null):c.unlinkSync(t)}catch(l){if(l.code==="ENOENT")return;if(l.code==="EPERM")return D?o(t,c,l):u(t,c,l);if(l.code!=="EISDIR")throw l;u(t,c,l)}}}function u(t,c,e){s(t),s(c),e&&s(e instanceof Error);try{c.rmdirSync(t)}catch(a){if(a.code==="ENOENT")return;if(a.code==="ENOTDIR")throw e;(a.code==="ENOTEMPTY"||a.code==="EEXIST"||a.code==="EPERM")&&r(t,c)}}function r(t,c){s(t),s(c),c.readdirSync(t).forEach(function(l){i(d.join(t,l),c)});var e=D?100:1,a=0;do{var f=!0;try{var v=c.rmdirSync(t,c);return f=!1,v}finally{if(++a<e&&f)continue}}while(!0)}return De}var Pe,cr;function Ur(){if(cr)return Pe;cr=1;var s=U,d=H,b=parseInt("0777",8);Pe=I.mkdirp=I.mkdirP=I;function I(E,S,A,D){typeof S=="function"?(A=S,S={}):(!S||typeof S!="object")&&(S={mode:S});var R=S.mode,_=S.fs||d;R===void 0&&(R=b),D||(D=null);var k=A||function(){};E=s.resolve(E),_.mkdir(E,R,function(x){if(!x)return D=D||E,k(null,D);switch(x.code){case"ENOENT":if(s.dirname(E)===E)return k(x);I(s.dirname(E),S,function(o,p){o?k(o,p):I(E,S,k,p)});break;default:_.stat(E,function(o,p){o||!p.isDirectory()?k(x,D):k(null,D)});break}})}return I.sync=function E(S,A,D){(!A||typeof A!="object")&&(A={mode:A});var R=A.mode,_=A.fs||d;R===void 0&&(R=b),D||(D=null),S=s.resolve(S);try{_.mkdirSync(S,R),D=D||S}catch(x){switch(x.code){case"ENOENT":D=E(s.dirname(S),A,D),E(S,A,D);break;default:var k;try{k=_.statSync(S)}catch{throw x}if(!k.isDirectory())throw x;break}}return D},Pe}var ur;function gr(){return ur||(ur=1,function(s,d){let b=H,I=U,E=Pr,S=ae,A=Wr(),D=Ur();ae.tmpdir();const R=A.sync;let _=I.resolve(S.tmpdir()),k=E.O_CREAT|E.O_TRUNC|E.O_RDWR|E.O_EXCL,x=function(w){if(typeof w=="function")return[void 0,w];var P,M=new Promise(function(C,N){P=function(){var q=Array.from(arguments),G=q.shift();process.nextTick(function(){G?N(G):q.length===1?C(q[0]):C(q)})}});return[M,P]};var o=function(w,P){var M=p(w,P),C=new Date,N=[M.prefix,C.getFullYear(),C.getMonth(),C.getDate(),"-",process.pid,"-",(Math.random()*4294967296+1).toString(36),M.suffix].join("");return I.join(M.dir||_,N)},p=function(w,P){var M={prefix:null,suffix:null};if(w)switch(typeof w){case"string":M.prefix=w;break;case"object":M=w;break;default:throw new Error("Unknown affix declaration: "+M)}else M.prefix=P;return M},g=!1,i=function(w){return g=w!==!1,s.exports},u=!1,r=[],t=[];function c(w){if(!g)return!1;a(),r.push(w)}function e(w){if(!g)return!1;a(),t.push(w)}function a(){if(!g)return!1;u||(process.addListener("exit",function(){try{h()}catch(w){throw console.warn("Fail to clean temporary files on exit : ",w),w}}),u=!0)}function f(){if(!g)return!1;for(var w=0,P;(P=r.shift())!==void 0;)R(P,{maxBusyTries:6}),w++;return w}function v(w){var P=x(w),M=P[0];if(w=P[1],!g)return w(new Error("not tracking")),M;var C=0,N=r.length;if(!N)return w(null,C),M;for(var q,G=function($){if(N){if($){w($),N=0;return}else C++;N--,N||w(null,C)}};(q=r.shift())!==void 0;)A(q,{maxBusyTries:6},G);return M}function l(){if(!g)return!1;for(var w=0,P;(P=t.shift())!==void 0;)R(P,{maxBusyTries:6}),w++;return w}function n(w){var P=x(w),M=P[0];if(w=P[1],!g)return w(new Error("not tracking")),M;var C=0,N=t.length;if(!N)return w(null,C),M;for(var q,G=function($){if(N){if($){w($,C),N=0;return}else C++;N--,N||w(null,C)}};(q=t.shift())!==void 0;)A(q,{maxBusyTries:6},G);return M}function h(){if(!g)return!1;var w=f(),P=l();return{files:w,dirs:P}}function y(w){var P=x(w),M=P[0];return w=P[1],g?(v(function(C,N){C?w(C,{files:N}):n(function(q,G){w(q,{files:N,dirs:G})})}),M):(w(new Error("not tracking")),M)}const m=(w,P)=>{const M=x(P),C=M[0];P=M[1];let N=o(w,"d-");return D(N,448,q=>{q||e(N),P(q,N)}),C},O=w=>{let P=o(w,"d-");return D.sync(P,448),e(P),P},T=(w,P)=>{const M=x(P),C=M[0];P=M[1];const N=o(w,"f-");return b.open(N,k,384,(q,G)=>{q||c(N),P(q,{path:N,fd:G})}),C},j=w=>{const P=o(w,"f-");let M=b.openSync(P,k,384);return c(P),{path:P,fd:M}},B=w=>{const P=o(w,"s-");let M=b.createWriteStream(P,{flags:k,mode:384});return c(P),M};d.dir=_,d.track=i,d.mkdir=m,d.mkdirSync=O,d.open=T,d.openSync=j,d.path=o,d.cleanup=y,d.cleanupSync=h,d.createWriteStream=B}(se,se.exports)),se.exports}var Ie,lr;function Yr(){if(lr)return Ie;lr=1;const s=Me.exec,d=gr(),b=H,I=Ce(),E=U,{unlinkP:S,readAndUnlinkP:A}=I;function D(u={}){const r=t=>new Promise((c,e)=>{const a=t.length;if(a===0)return e(new Error("No displays detected try dropping screen option"));const f=a-1,v=u.screen||0;if(!Number.isInteger(v)||v<0||v>f){const O=f===0?"(valid choice is 0 or drop screen option altogether)":`(valid choice is an integer between 0 and ${f})`;return e(new Error(`Invalid choice of displayId: ${v} ${O}`))}const l=u.format||"jpg";let n,h;if(u.filename){const O=u.filename.lastIndexOf(".");h=O>=0?u.filename.slice(O):`.${l}`,n='"'+u.filename.replace(/"/g,'\\"')+'"'}else h=`.${l}`;const y=Array(v+1).fill(null).map(()=>d.path({suffix:h}));let m=[];u.filename&&(y[v]=n),m=y.slice(0,v+1),s("screencapture -x -t "+l+" "+m.join(" "),function(O,T){if(O)return e(O);u.filename?c(E.resolve(u.filename)):b.readFile(y[v],function(j,B){if(j)return e(j);Promise.all(m.map(S)).then(()=>c(B)).catch(w=>e(w))})})});return g().then(t=>r(t))}const R=`
Graphics/Displays:

    Intel Iris:

      Chipset Model: Intel Iris
      Type: GPU
      Bus: Built-In
      VRAM (Dynamic, Max): 1536 MB
      Vendor: Intel (0x8086)
      Device ID: 0x0a2e
      Revision ID: 0x0009
      Displays:
        Color LCD:
          Display Type: Retina LCD
          Resolution: 2560 x 1600 Retina
          Retina: Yes
          Pixel Depth: 32-Bit Color (ARGB8888)
          Main Display: Yes
          Mirror: Off
          Online: Yes
          Built-In: Yes
        HP 22cwa:
          Resolution: 1920 x 1080 @ 60Hz (1080p)
          Pixel Depth: 32-Bit Color (ARGB8888)
          Display Serial Number: 6CM7201231
          Mirror: Off
          Online: Yes
          Rotation: Supported
          Television: Yes
`;function _(u){const r=[],t=/(\s*)(.*?):(.*)\n/g;let c;for(;(c=t.exec(u))!==null;)r.push({indent:c[1].length,key:c[2].trim(),value:c[3].trim()});return r}function k(u,r,t){let c;for(;c=t.shift();)if(c.value==="")if(u<c.indent){for(;c.key in r;)c.key+="_1";r[c.key]={},k(c.indent,r[c.key],t)}else{t.unshift(c);return}else{for(;c.key in r;)c.key+="_1";r[c.key]=c.value}}function x(u){const r=u.filter(c=>c.primary),t=u.filter(c=>!c.primary);return[...r,...t]}function o(u){let r=0;return u.map(t=>Object.assign({},t,{id:r++}))}function p(u){const r={};if(k(-1,r,_(u)),!r["Graphics/Displays"])return[];const t=Object.keys(r["Graphics/Displays"]);if(!t||t.length<=0)return[];let c=[];return t.forEach(e=>{const a=r["Graphics/Displays"][e];if(a.Displays){const f=Object.entries(a.Displays).map(([v,l])=>{const n=l["Main Display"]==="Yes";return{name:v,primary:n}});c=c.concat(f)}}),o(x(c))}function g(){return new Promise((u,r)=>{s("system_profiler SPDisplaysDataType",(t,c)=>{if(t)return r(t);u(p(c))})})}function i(){return new Promise((u,r)=>{g().then(t=>{const c=t.map(()=>d.path({suffix:".jpg"}));s("screencapture -x -t jpg "+c.join(" "),function(e,a){if(e)return r(e);Promise.all(c.map(A)).then(u).catch(r)})})})}return D.listDisplays=g,D.all=i,D.parseDisplaysOutput=p,D.EXAMPLE_DISPLAYS_OUTPUT=R,Ie=D,Ie}var Re,fr;function zr(){if(fr)return Re;fr=1;const s=Me.exec,d=gr(),b=U,I=Ce(),E=H,S=ae,{readAndUnlinkP:A,defaultAll:D}=I;function R(){const p=b.join(S.tmpdir(),"screenCapture","screenCapture_1.3.2.bat"),g=b.join(S.tmpdir(),"screenCapture","app.manifest"),i=b.join(__dirname,"screenCapture_1.3.2.bat").replace("app.asar","app.asar.unpacked"),u=b.join(__dirname,"app.manifest").replace("app.asar","app.asar.unpacked");if(!E.existsSync(p)){const r=b.join(S.tmpdir(),"screenCapture");E.existsSync(r)||E.mkdirSync(r);const t={bat:E.readFileSync(i),manifest:E.readFileSync(u)};E.writeFileSync(p,t.bat),E.writeFileSync(g,t.manifest)}return p}function _(p={}){return new Promise((g,i)=>{const u=p.screen,r=p.format||"jpg",t=d.path({suffix:`.${r}`}),c=b.resolve(p.filename||t),e=u?` /d "${u}"`:"",a=R();s('"'+a+'" "'+c+'" '+e,{cwd:b.join(S.tmpdir(),"screenCapture"),windowsHide:!0},(f,v)=>{if(f)return i(f);p.filename?g(c):A(t).then(g).catch(i)})})}const k=`\r
C:\\Users\\devetry\\screenshot-desktop\\lib\\win32>//  2>nul  || \r
\\.\\DISPLAY1;0;1920;1080;0\r
\\.\\DISPLAY2;0;3840;1080;1920\r
`;function x(p){const g=/2>nul {2}\|\| /,{0:i,index:u}=g.exec(p);return p.slice(u+i.length).split(`
`).map(r=>r.replace(/[\n\r]/g,"")).map(r=>r.match(/(.*?);(.?\d+);(.?\d+);(.?\d+);(.?\d+);(.?\d*[\.,]?\d+)/)).filter(r=>r).map(r=>({id:r[1],name:r[1],top:+r[2],right:+r[3],bottom:+r[4],left:+r[5],dpiScale:+r[6].replace(",",".")})).map(r=>Object.assign(r,{height:r.bottom-r.top,width:r.right-r.left}))}function o(){return new Promise((p,g)=>{const i=R();s('"'+i+'" /list',{cwd:b.join(S.tmpdir(),"screenCapture")},(u,r)=>{if(u)return g(u);p(x(r))})})}return _.listDisplays=o,_.availableDisplays=o,_.parseDisplaysOutput=x,_.EXAMPLE_DISPLAYS_OUTPUT=k,_.all=()=>D(_),Re=_,Re}process.platform==="linux"?ne.exports=jr():process.platform==="darwin"?ne.exports=Yr():process.platform==="win32"?ne.exports=zr():ne.exports=function(){return Promise.reject(new Error("Currently unsupported platform. Pull requests welcome!"))};var Xr=ne.exports;const wr=Mr(Xr),Hr=require("child_process").exec;function Qr(s,d){!s||!d||(s.webContents.send("start-capture"),s.setOpacity(1),s.setBounds(d),s.setIgnoreMouseEvents(!1))}async function Vr(s){try{return await wr({screen:s,format:"png"})}catch{console.error("getCaptureWindowSources is error")}}function Zr(s){const d=L.nativeImage.createFromDataURL(s);L.clipboard.writeImage(d)}async function Kr(s,d){try{if(!s)return!1;const b=d.match(/^data:image\/(\w+);base64,(.+)$/);if(!b)throw new Error("Invalid data URL");const[,I,E]=b,S=Buffer.from(E,"base64"),{filePath:A,canceled:D}=await L.dialog.showSaveDialog(s,{title:"Download Image",defaultPath:`FengCh-${Date.now()}.${I}`});if(D)return;await Rr.writeFile(A,S)}catch{console.error("handleDownloadImage is error")}}function Jr(){const s=L.screen.getAllDisplays();let d=[];return s.forEach(b=>{let I={id:b.id,label:b.label,size:b.size,bounds:b.bounds,scaleFactor:b.scaleFactor};d.push(I)}),d}async function et(s){if(process.platform==="linux"||!s)return;Er()||(await rt(s)).response===0&&Hr("open x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture")}async function rt(s){return s?await L.dialog.showMessageBox(s,{title:"权限申请",message:"当前应用无屏幕捕获权限，即将跳转至授权页面，请授权后重新启动应用。",textWidth:450}):{response:1}}function Er(){return L.systemPreferences.getMediaAccessStatus("screen")==="granted"}function tt(s){new L.Notification({title:"screen shot",body:s}).show()}const Sr=ae.platform()==="darwin";process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";let Y,fe,hr,z=[],he=0;const br=()=>{Y=new L.BrowserWindow({frame:!1,width:450,height:600,skipTaskbar:!1,alwaysOnTop:!1,show:!0,webPreferences:{webSecurity:!1,nodeIntegration:!1,contextIsolation:!0,preload:U.join(__dirname,"../dist-electron/preload.js")}}),Y.setSkipTaskbar(!1),Z(),process.env.VITE_DEV_SERVER_URL?Y.loadURL(process.env.VITE_DEV_SERVER_URL):Y.loadFile(U.join(__dirname,"../dist/index.html"))};L.app.whenReady().then(()=>{nt(),L.app.on("activate",()=>{L.BrowserWindow.getAllWindows().length===0&&br()}),L.screen.on("display-metrics-changed",async()=>{z=[],Z()})});L.app.on("window-all-closed",()=>{process.platform!=="darwin"&&L.app.quit()});async function nt(){await xr(),st(),br(),et(Y),ot()}function it(s){return z.find(d=>d.id===s)}async function xr(){fe=Jr(),hr=await wr.listDisplays(),hr.forEach(s=>{fe.map(d=>{if(Sr)(d.label===s.name||d.label==="内建视网膜显示器")&&(d.id=s.id);else{const{width:b,height:I}=d.bounds;if(s.width===void 0||s.height===void 0||s.dpiScale===void 0)return;b===s.width/s.dpiScale&&I===s.height/s.dpiScale?(d.scaleFactor=s.dpiScale,d.id=s.id):(Math.floor(b*d.scaleFactor)===s.width&&Math.floor(I*d.scaleFactor)===s.height||Math.ceil(b*d.scaleFactor)===s.width&&Math.ceil(I*d.scaleFactor)===s.height)&&(d.id=s.id)}})})}function ie(){z.forEach(s=>s.close()),z=[]}function at(s){return fe.find(d=>d.wId===s)}async function Te(){if(!Er())return tt("请先授权应用捕获屏幕权限！");z.forEach(s=>{var b;const d=(b=at(s.id))==null?void 0:b.bounds;Qr(s,d)})}function st(){L.ipcMain.handle("screen:shot",()=>{Te()}),L.ipcMain.handle("captureWindow:sources",async(s,d)=>await Vr(d)),L.ipcMain.handle("window:close",()=>{ie(),Y==null||Y.close(),L.app.quit(),console.log("------> close allWindow success!")}),L.ipcMain.handle("window:minimize",()=>{Y==null||Y.minimize(),console.log("------> minimize allWindow success!")}),L.ipcMain.handle("captureWindow:close",async()=>{ie(),Z(),console.log("------> close captureWindow success!")}),L.ipcMain.handle("saveClipboard:image",(s,d)=>{console.log("------> saveClipboard:image success!"),Zr(d)}),L.ipcMain.handle("download:image",async(s,d,b)=>{try{const I=it(d);if(!I)return;await Kr(I,b),ie(),Z(),console.log("------> download:image success!")}catch{console.error("download:image is error")}}),L.ipcMain.handle("clearOtherCanvas",(s,d)=>{z.forEach(b=>{b.id!==d&&b.webContents.send("clear:canvas")})}),L.ipcMain.on("captureWindowShow:ready",()=>{he++,he===z.length&&z.forEach(s=>{s.webContents.send("captureWindow:show")})})}async function Z(){await xr();try{fe.map(async s=>{const d=await Tr(Sr);s.wId=d.id,d.webContents.send("transport-screen-and-window-data",JSON.stringify({screenData:s,captureWindowId:d.id})),z.push(d),he=0}),console.log("------> preloadCaptureWindiow is success!")}catch{console.error("------> preloadCaptureWindiow is error!")}}function ot(){ae.platform()==="darwin"?(console.log("------> registerShotcut success!"),L.globalShortcut.register("Command+P",()=>{he!==z.length&&Te()}),L.globalShortcut.register("Command+Shift+P",()=>{ie(),Z()})):L.globalShortcut.register("Ctrl+P",()=>{Te()}),L.globalShortcut.register("Esc",()=>{ie(),Z()})}
